%%
%obtain data in matrix form from struct generated by wavefront.m file
clear all;
dirs=dir('E:\Wavefront20150513\diffwave\*.mat');   % 用你需要的目录以及文件扩展名替换。读取某个目录的指定类型文件列表，返回结构数组。
dircell=struct2cell(dirs)' ;    % 结构体(struct)转换成元胞类型(cell)，转置一下是让文件名按列排列。
filenames=dircell(:,1);   % 第一列是文件名



NumPar=numel(filenames);%Number of para_diff set
NumPoint=50;%Number of data point per each set
NumData=NumPar*NumPoint;%Total number of Data
SR=zeros(NumData,1);
SRdl=SR;
ECdl=SR;
rof80x=SR;
rof80y=SR;
EC=zeros(NumData,1);
PV=zeros(NumData,1);
RMS=zeros(NumData,1);
GRMS=zeros(NumData,1);
GPV=zeros(NumData,1);
for i=1:NumPar
load(['E:\Wavefront20150513\diffwave\',char(filenames(i))]);
    for j=1:numel(para_diff)
        idx=(i-1)*50+j;
        SR(idx)=para_diff(j).SR;
        SRdl(idx)=para_diff(j).SRdl;
        ECdl(idx)=para_diff(j).ECdl;
        rof80x(idx)=para_diff(j).rof80(1);
        rof80y(idx)=para_diff(j).rof80(2);
        PV(idx)=para_diff(j).PV;
        RMS(idx)=para_diff(j).RMS;
        GRMS(idx)=para_diff(j).GRMS;
        GPV(idx)=para_diff(j).GPV;
    end
        clear para_diff 
end
save ('E:\Wavefront20150513\diffwave\pardiffdata.mat','SR','SRdl','ECdl','rof80x','rof80y','PV','RMS','GRMS','GPV');